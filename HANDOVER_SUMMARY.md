# プロジェクト引継ぎ用サマリー（AutoManual開発）

## 【達成済みの実装・フェーズ】

### 1. マニュアル生成・エクスポート機能の完成
- **PDF出力 (`pdfExporter.ts`)**: 完璧なレイアウト、改ページ制御、SVGグラフィックのナンバリング、ポートレート画像の3:4アスペクト比保持を実装。
- **PPTX出力 (`pptxExporter.ts`)**: PDF版と同様の計算し尽くされた完璧なSVGセンター出し（Arial Black）、画像の横伸び防止（`sizing: contain`）、フッター位置の精密調整、Meiryo UIフォントの適用。
- **Word出力 (`docxExporter.ts`)**: 最新の大規模レイアウト改善が完了。
    - **行分割構造**: 2カラム時は「表題行」「詳細行」「画像行」の3行テーブルで高さを物理的に同期。
    - **改ページ安全**: `keepNext: true` + `cantSplit: true` で、テキストと画像の泣き別れを防止。
    - **ナンバリング上端固定**: `VerticalAlign.TOP` により、長い表題でも丸数字が常に1行目に固定。
    - **2カラム専用フォントスケーリング**: 表題14pt / 詳細11pt に自動調整。
    - **表紙の左寄せデザイン**: PDFと統一感のある余白同期レイアウト。

### 2. パフォーマンスと処理最適化
- **デュアルビデオ戦略**: プロキシ動画を用いた高速AI解析と、元動画からの並列高画質スクリーンショット抽出（ロスレスPNG）を実現。
- **大容量画像警告**: 5000px超の画像アップロード時に確認ダイアログを表示。
- **UI/UX**: プログレスバーの自然なシミュレーション進行調整を実装。

### 3. AIプロンプトチューニング
- 画面の変更やポップアップを積極的に捉え、網羅性を重視するプロンプトへの粒度調整を実施。

### 4. 複数動画サポートと動画個別レイアウト機能の完成
- **スマートナンバリング**: 複数動画をアップロードした際、新しい動画のステップは必ず「1」から始まるように内部のロジックを修正。ドラッグ＆ドロップ時の並び替え時も動画グループ別に独立した連番を維持。
- **個別レイアウトアーキテクチャ**: 全体単位でレイアウトを指定していたこれまでの仕組みを撤廃し、`ManualStep` インターフェースに直接 `layout: 'single' | 'two-column'` プロパティを持たせることで、**「動画セクションごとに異なるレイアウト（1列/2列）」を混在**できるようアーキテクチャを刷新。
- **エクスポートの混在使用対応**: PDF、Word、PPTXのすべてにおいて、出力ループ中でそのステップごとの `layout` を判定し、1個のファイル内で1列・2列レイアウトをシームレスに混在・改ページして出力できるように再実装完了。

## 【現在の状況】
PDF / PPTX / Word の全エクスポート形式に関し、完璧なレイアウト品質にくわえ、**「動画ごとのナンバリング自動リセット」と「セクションごとの個別レイアウト（1列/2列）の混在出力」**が実装され、GitHub (`main`ブランチ) にプッシュ済みの状態です。
各エクスポート形式は2カラムレイアウトにも完全対応しており、本番品質のマニュアル生成が可能です。

## 【主要ファイル】
| ファイル | 役割 |
|---|---|
| `utils/exporters/docxExporter.ts` | Word出力（行分割2カラム同期、改ページ防止） |
| `utils/exporters/pptxExporter.ts` | PPTX出力（SVGナンバリング、アスペクト比保持） |
| `utils/exporters/pdfExporter.ts` | PDF出力（印刷品質、改ページ制御） |
| `components/ExportButton.tsx` | エクスポートUIと全形式の呼び出し制御 |
| `app/page.tsx` | メインUI（`ManualData`型定義を含む） |
