# AutoManual Studio

**動画をアップロードするだけで、AIが自動的にステップバイステップの手順書を生成する次世代マニュアル作成ツールです。**

Google Gemini 2.5 Flash のマルチモーダル機能を活用し、画面操作の動画から操作手順とスクリーンショットを自動抽出し、編集可能なマニュアルとして出力します。

## 主な機能

- **動画からAI自動生成**: 動画内の操作をAIが解析し、正確な手順テキストとスクリーンショットを数秒で生成。
- **リアルタイム進捗表示**: AI分析中〜画像切り出し完了まで、見やすいプログレスバーでリアルタイムに進捗を表示。
- **マルチフォーマット・エクスポート**:
    - **Word (.docx)**: 標準 / 2列レイアウト対応。左右の高さ同期・改ページ安全・プロ品質レイアウト。
    - **PowerPoint (.pptx)**: 標準 / 2列レイアウト対応。SVGナンバリング・Meiryo UIフォント完全適用。
    - **PDF**: 印刷や共有に最適（標準 / 2列レイアウト対応）。
    - **Markdown**: ドキュメント管理やWikiへの貼り付けに。
    - **HTML**: Webページとして即時公開可能。
- **ドラッグ＆ドロップ並び替え**: 編集モードで手順の順番をドラッグで自由に変更可能。ステップ番号は自動で振り直されます。
- **高機能画像エディター (Inline Canvas)**:
    - スクリーンショット上に矢印、枠線、テキスト、スタンプ（項番）、ぼかし、ハイライトを直接追加可能。
    - PowerPointライクな直感的な操作感（Fabric.js採用）。
- **セキュアな処理**: 動画データは一時的な解析にのみ使用され、プライバシーに配慮。

## 最新アップデート (v4.5 - 2026/02/25)

### Word出力の大幅レイアウト改善
- **行分割構造による左右同期**: 2カラム時は「表題行」「詳細行」「画像行」の3段構成テーブルで管理。テキスト量の差があっても、ナンバリングと画像が必ず同じ高さから開始されます。
- **ページ跨ぎ防止**: `keepNext` + `cantSplit` を全テーブル行に適用。テキストと画像の"泣き別れ"を防止。
- **ナンバリングの上端固定**: 丸数字が常に表題の1行目に固定され、タイトルが複数行になっても崩れません。
- **表紙の左寄せデザイン**: PDFデザインと統一感のある左寄せレイアウトとマージン整合。
- **2カラム専用フォントスケーリング**: 表題14pt / 詳細11ptに自動調整して狭いカラムでも可読性を確保。

### 過去のアップデート

<details>
<summary>v4.4 (2026/02/18)</summary>

- **プログレスバー追加**: 生成処理中にAI分析→画像切り出しの進捗をリアルタイム表示。
- **ドラッグ＆ドロップ並び替え**: 編集モードでステップをドラッグして自由に並び替え可能に。
- **コードのモジュール化**: エクスポート機能を独立したモジュール（DOCX / PPTX / PDF）に分離し、保守性を向上。

</details>

<details>
<summary>v4.3 (2026/02/15)</summary>

- 全動画形式の高速アップロード（iPhone MOV / 4K MP4 → WebM自動変換）。
- Gemini 2.5 Flash Preview 採用によるAIエンジン強化。
- プロンプト全面改訂による「操作の抜け漏れ」最小化。

</details>

## 対応動画仕様

### 制限事項
- **最大ファイルサイズ**: 500MB (ブラウザからのアップロード制限)
- **タイムアウト**: 10分 (サーバーサイド処理制限)
- **推奨環境**: ローカル環境 (`npm run dev`) での実行を推奨します。

### 対応フォーマット
以下の動画形式に対応しており、解析前に自動的に最適な形式へ変換・圧縮されます。
- **MP4** (.mp4, .m4v)
- **QuickTime** (.mov)
- **WebM** (.webm)
- **AVI** (.avi)
- **3GP** (.3gp, .3g2)
- **MPEG** (.mpg, .mpeg)

※ 4K動画や高フレームレート(60fps)の動画も対応可能ですが、解析精度向上のため、文字がつぶれていない鮮明な全画面録画の使用を推奨します。

## 推奨される動画サイズと制限

### ローカル環境 (`npm run dev`)
- **長さ**: 20分以上も対応可能（Gemini モデルの制限に準拠）
- **ファイルサイズ**: 2GB未満
- **制限**: タイムアウトがないため、マシンスペックとAPI割り当てが許す限り長時間の動画も解析可能です。

### クラウド環境 (Vercel, Netlify, Cloud Run 等)

**サーバーレス環境 (Vercel Free/Pro) の場合:**
- **制限**: 
    1. **アップロード上限**: 4.5MB (Vercel Serverless Functions の制約)
    2. **タイムアウト**: 10秒〜60秒
- **結果**: 実質的に、数秒〜数十秒の非常に短い動画しか処理できません。

**コンテナ / VPS 環境 (Railway, AWS EC2, DigitalOcean 等) の場合:**
- **長さ**: 20分以上も対応可能
- **制限**: サーバーのリソース（メモリ・ディスク）に依存します。タイムアウト設定を延長すれば、ローカル同様に長時間動画も解析可能です。

※ 本ツールの現状のアーキテクチャはローカル実行またはVPS運用に最適化されています。

## 将来的なデプロイについて

本ツールをクラウド上で本格運用する場合、**長時間動画の解析** に対応するためには、以下の構成を推奨します。

### 推奨構成: Dockerコンテナ / VPS
- **プラットフォーム**: Railway, Render, AWS App Runner, DigitalOcean App Platform, または任意のVPS
- **メリット**:
    - タイムアウト時間を長く設定可能（例: 5分〜無制限）。
    - ディスク容量やメモリを確保しやすい。
    - `npm run start` でローカル同様の長時間プロセスを実行可能。

### 非推奨: サーバーレス機能 (Vercel Functions等)
- **デメリット**:
    - 10秒〜60秒で強制終了されるため、動画解析が完了しません。
    - 4.5MB以上のファイルアップロードがブロックされます。

### Railway / Render へのデプロイ（例）

本リポジトリには標準的な `Next.js` アプリケーションが含まれており、多くのPaaSで自動検出されデプロイ可能です。
環境変数 `GEMINI_API_KEY` を設定するだけで動作します。

## プロジェクト構成

| カテゴリ | 技術 |
| --- | --- |
| Frontend | Next.js 14, TypeScript, Tailwind CSS |
| AI Engine | Google Gemini 2.5 Flash |
| Canvas Engine | Fabric.js v6 |
| PDF Generation | html2pdf.js / html2canvas / jsPDF |
| Word Generation | docx |
| PowerPoint Generation | pptxgenjs |
| Drag & Drop | @hello-pangea/dnd |

## セットアップ & 実行

```bash
# 依存関係のインストール
npm install

# 環境変数の設定 (.env.local)
# GEMINI_API_KEY=your_api_key_here

# 開発サーバーの起動
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてください。

詳細なインストール手順（他のPCでのセットアップ方法など）については、[INSTALLATION.md](./INSTALLATION.md) を参照してください。

---
Produced by Antigravity AI
